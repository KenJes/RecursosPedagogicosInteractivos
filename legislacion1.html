<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Legislaci√≥n Inform√°tica - M√≥dulo Interactivo</title>
    <style>
        /* Variables CSS para colores suaves y arm√≥nicos */
        :root {
            --primary-color: #5B8FB9;
            --secondary-color: #7CB9A8;
            --accent-color: #E8D5B7;
            --background-color: #F5F5F5;
            --card-bg: #FFFFFF;
            --text-primary: #2C3E50;
            --text-secondary: #5D6D7E;
            --success-color: #7CB9A8;
            --error-color: #D4A5A5;
            --progress-bg: #E0E0E0;
            --completed-color: #A8D5BA;
            --shadow-light: rgba(0, 0, 0, 0.08);
        }

        /* Reset y estilos base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background-color);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Contenedor principal */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Pantalla de registro */
        .register-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        .register-card {
            background: var(--card-bg);
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 4px 20px var(--shadow-light);
            text-align: center;
            max-width: 450px;
            width: 100%;
        }

        .register-card h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 1.8rem;
        }

        .register-card p {
            color: var(--text-secondary);
            margin-bottom: 30px;
        }

        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-primary);
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        /* Botones */
        .btn {
            padding: 12px 32px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: #4A7A9E;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-secondary:hover {
            background-color: #6AA897;
        }

        /* Header del m√≥dulo */
        .module-header {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px var(--shadow-light);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .welcome-text h2 {
            color: var(--primary-color);
            font-size: 1.4rem;
        }

        .welcome-text p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Barra de progreso */
        .progress-container {
            flex: 1;
            max-width: 400px;
            min-width: 250px;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .progress-bar {
            height: 12px;
            background-color: var(--progress-bg);
            border-radius: 6px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 6px;
            transition: width 0.5s ease;
            width: 0%;
        }

        /* Grid de tarjetas */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        /* Tarjetas interactivas */
        .topic-card {
            background: var(--card-bg);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 15px var(--shadow-light);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .topic-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px var(--shadow-light);
        }

        .topic-card.completed {
            border: 3px solid var(--completed-color);
        }

        .topic-card.completed::after {
            content: "Completado";
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--completed-color);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .card-visual {
            height: 160px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .card-icon {
            font-size: 4rem;
            opacity: 0.9;
        }

        .card-content {
            padding: 20px;
        }

        .card-content h3 {
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .card-content p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--card-bg);
            border-radius: 16px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #E0E0E0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            color: var(--primary-color);
            font-size: 1.3rem;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: var(--text-primary);
        }

        .modal-body {
            padding: 20px;
        }

        .infographic {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .infographic-title {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px dashed var(--primary-color);
        }

        .infographic-title h3 {
            color: var(--primary-color);
            font-size: 1.4rem;
        }

        .info-points {
            list-style: none;
        }

        .info-points li {
            padding: 12px 0;
            padding-left: 30px;
            position: relative;
            color: var(--text-primary);
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .info-points li:last-child {
            border-bottom: none;
        }

        .info-points li::before {
            content: ">";
            position: absolute;
            left: 0;
            color: var(--secondary-color);
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* Secci√≥n de pregunta */
        .question-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .question-section h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .options-list {
            list-style: none;
        }

        .option-item {
            margin-bottom: 10px;
        }

        .option-btn {
            width: 100%;
            padding: 12px 16px;
            background: white;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }

        .option-btn:hover {
            border-color: var(--primary-color);
            background: #f8f9fa;
        }

        .option-btn.correct {
            background: var(--success-color);
            border-color: var(--success-color);
            color: white;
        }

        .option-btn.incorrect {
            background: var(--error-color);
            border-color: var(--error-color);
            color: white;
        }

        /* Feedback */
        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }

        .feedback.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .feedback.success {
            background: rgba(124, 185, 168, 0.2);
            border-left: 4px solid var(--success-color);
        }

        .feedback.hint {
            background: rgba(232, 213, 183, 0.4);
            border-left: 4px solid var(--accent-color);
        }

        .feedback h5 {
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .feedback p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Pantalla de certificado */
        .certificate-screen {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .certificate-screen.active {
            display: block;
        }

        .certificate-preview {
            background: white;
            border: 3px solid var(--primary-color);
            border-radius: 16px;
            padding: 40px;
            max-width: 700px;
            margin: 20px auto;
            box-shadow: 0 4px 20px var(--shadow-light);
        }

        .certificate-header {
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .certificate-header h1 {
            color: var(--primary-color);
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .certificate-header p {
            color: var(--text-secondary);
        }

        .certificate-body h2 {
            color: var(--text-primary);
            font-size: 1.8rem;
            margin: 20px 0;
        }

        .certificate-body p {
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .certificate-footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #E0E0E0;
            display: flex;
            justify-content: space-between;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .download-section {
            margin-top: 30px;
        }

        /* Ocultar elementos */
        .hidden {
            display: none !important;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .progress-container {
                width: 100%;
                max-width: none;
            }

            .certificate-preview {
                padding: 20px;
            }

            .certificate-footer {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Pantalla de Registro -->
    <div id="registerScreen" class="register-screen">
        <div class="register-card">
            <h1>Legislacion Informatica</h1>
            <p>Modulo interactivo de aprendizaje sobre conceptos basicos de legislacion en el ambito digital</p>
            <div class="input-group">
                <label for="studentName">Ingresa tu nombre completo</label>
                <input type="text" id="studentName" placeholder="Ej: Juan Perez Garcia" autocomplete="name">
            </div>
            <button class="btn btn-primary" onclick="startModule()">Comenzar Aprendizaje</button>
            <p id="registerError" style="color: var(--error-color); margin-top: 15px; display: none;">Por favor, ingresa tu nombre para continuar.</p>
        </div>
    </div>

    <!-- Pantalla Principal del M√≥dulo -->
    <div id="moduleScreen" class="container hidden">
        <header class="module-header">
            <div class="header-content">
                <div class="welcome-text">
                    <h2>Bienvenido, <span id="displayName"></span></h2>
                    <p>Explora cada tema y responde las preguntas para completar el modulo</p>
                </div>
                <div class="progress-container">
                    <div class="progress-label">
                        <span>Progreso del modulo</span>
                        <span id="progressText">0 de 8 completados</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>
            </div>
        </header>

        <main class="cards-grid" id="cardsContainer"></main>
    </div>

    <!-- Pantalla de Certificado -->
    <div id="certificateScreen" class="certificate-screen">
        <h1 style="color: var(--primary-color); margin-bottom: 10px;">Felicidades</h1>
        <p style="color: var(--text-secondary); margin-bottom: 30px;">Has completado exitosamente el modulo de Legislacion Informatica</p>
        
        <div class="certificate-preview" id="certificateContent">
            <div class="certificate-header">
                <h1>Certificado de Competencia</h1>
                <p>Legislacion Informatica - Conceptos Basicos</p>
            </div>
            <div class="certificate-body">
                <p>Se certifica que</p>
                <h2 id="certificateName"></h2>
                <p>ha completado satisfactoriamente el modulo interactivo de</p>
                <p style="font-size: 1.2rem; color: var(--primary-color); font-weight: 600;">Legislacion Informatica</p>
                <p style="margin-top: 20px;">demostrando conocimientos en:</p>
                <p style="font-style: italic;">Derecho informatico, Proteccion de datos, Propiedad intelectual digital, Delitos informaticos, Comercio electronico, Privacidad en internet, Regulacion de redes sociales y Ciberseguridad.</p>
            </div>
            <div class="certificate-footer">
                <span>Fecha: <span id="certificateDate"></span></span>
                <span>Modulo Educativo Interactivo</span>
            </div>
        </div>

        <div class="download-section">
            <button class="btn btn-primary" onclick="downloadCertificate()">Descargar Certificado PDF</button>
            <button class="btn btn-secondary" style="margin-left: 10px;" onclick="restartModule()">Reiniciar Modulo</button>
        </div>
    </div>

    <!-- Modal de Contenido -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <div class="modal-header">
                <h2 id="modalTitle"></h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <!-- Librer√≠a para generar PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        // Datos de los temas con contenido educativo y preguntas
        const topicsData = [
            {
                id: 1,
                title: "Derecho Informatico",
                description: "Fundamentos y conceptos basicos del derecho aplicado a la tecnologia",
                color: "#5B8FB9",
                icon: "¬ß",
                content: {
                    points: [
                        "Es la rama del derecho que regula las tecnologias de la informacion y comunicacion",
                        "Establece normas para el uso adecuado de sistemas informaticos",
                        "Protege los derechos de usuarios y empresas en el entorno digital",
                        "Regula las relaciones juridicas derivadas del uso de la tecnologia"
                    ]
                },
                question: {
                    text: "¬øCual es el objetivo principal del Derecho Informatico?",
                    options: [
                        "Crear software para empresas",
                        "Regular las relaciones juridicas en el entorno digital",
                        "Dise√±ar paginas web",
                        "Vender equipos de computo"
                    ],
                    correct: 1,
                    hints: [
                        "Piensa en que tipo de actividad realiza una rama del derecho...",
                        "El derecho siempre busca ordenar y proteger, ¬øque necesita proteccion en el mundo digital?"
                    ]
                }
            },
            {
                id: 2,
                title: "Proteccion de Datos Personales",
                description: "Normativas para el tratamiento de informacion personal",
                color: "#7CB9A8",
                icon: "üõ°",
                content: {
                    points: [
                        "Los datos personales son cualquier informacion que identifica a una persona",
                        "Las empresas deben obtener consentimiento para recopilar datos",
                        "Los usuarios tienen derecho a acceder, rectificar y cancelar sus datos",
                        "Existen sanciones por mal uso de informacion personal"
                    ]
                },
                question: {
                    text: "¬øQue derecho tienen los usuarios sobre sus datos personales?",
                    options: [
                        "Solo el derecho a proporcionarlos",
                        "Derecho a acceder, rectificar y cancelar sus datos",
                        "Ningun derecho una vez proporcionados",
                        "Solo pueden verlos pero no modificarlos"
                    ],
                    correct: 1,
                    hints: [
                        "Si los datos te pertenecen, ¬øque acciones deberian permitirte realizar sobre ellos?",
                        "Piensa en que harias si encontraras un error en tus datos guardados en algun sistema..."
                    ]
                }
            },
            {
                id: 3,
                title: "Propiedad Intelectual Digital",
                description: "Derechos de autor y proteccion de creaciones en internet",
                color: "#E8D5B7",
                icon: "¬©",
                content: {
                    points: [
                        "Protege creaciones originales como software, musica, imagenes y textos",
                        "El autor tiene derechos exclusivos sobre su obra",
                        "Las licencias definen como se puede usar contenido digital",
                        "La pirateria es una violacion a los derechos de autor"
                    ]
                },
                question: {
                    text: "¬øQue define como se puede utilizar legalmente un contenido digital?",
                    options: [
                        "El precio del contenido",
                        "La cantidad de descargas",
                        "Las licencias de uso",
                        "El tama√±o del archivo"
                    ],
                    correct: 2,
                    hints: [
                        "Cuando descargas un programa, ¬øque documento legal debes aceptar?",
                        "Piensa en el termino que describe los permisos otorgados por el creador..."
                    ]
                }
            },
            {
                id: 4,
                title: "Delitos Informaticos",
                description: "Conductas ilicitas cometidas mediante sistemas digitales",
                color: "#D4A5A5",
                icon: "‚ö†",
                content: {
                    points: [
                        "Incluyen hacking, phishing, malware y robo de identidad",
                        "Acceder sin autorizacion a sistemas es un delito",
                        "El fraude electronico tiene consecuencias penales",
                        "Las leyes tipifican y sancionan estas conductas"
                    ]
                },
                question: {
                    text: "¬øCual de las siguientes acciones constituye un delito informatico?",
                    options: [
                        "Crear una cuenta en redes sociales",
                        "Acceder sin autorizacion a un sistema ajeno",
                        "Enviar correos electronicos",
                        "Descargar aplicaciones de tiendas oficiales"
                    ],
                    correct: 1,
                    hints: [
                        "Un delito implica hacer algo sin el permiso correspondiente...",
                        "¬øQue accion de las mencionadas viola la privacidad o seguridad de otros?"
                    ]
                }
            },
            {
                id: 5,
                title: "Comercio Electronico",
                description: "Regulacion de transacciones comerciales en linea",
                color: "#A8D5BA",
                icon: "$",
                content: {
                    points: [
                        "Regula compras y ventas realizadas por medios electronicos",
                        "Los contratos electronicos tienen validez legal",
                        "Los consumidores tienen derechos de garantia y devolucion",
                        "Se requiere transparencia en precios y condiciones"
                    ]
                },
                question: {
                    text: "¬øQue validez tienen los contratos realizados electronicamente?",
                    options: [
                        "No tienen ninguna validez",
                        "Solo valen si se imprimen",
                        "Tienen validez legal igual que los fisicos",
                        "Solo valen para compras peque√±as"
                    ],
                    correct: 2,
                    hints: [
                        "Si las empresas grandes realizan transacciones millonarias en linea, ¬øque nos dice eso sobre su validez?",
                        "La ley ha evolucionado para reconocer las nuevas formas de hacer negocios..."
                    ]
                }
            },
            {
                id: 6,
                title: "Firma Digital",
                description: "Autenticacion electronica de documentos",
                color: "#B8C5D6",
                icon: "‚úì",
                content: {
                    points: [
                        "Es un mecanismo criptografico que garantiza autenticidad",
                        "Tiene la misma validez que una firma manuscrita",
                        "Permite verificar que un documento no fue alterado",
                        "Requiere certificados emitidos por autoridades reconocidas"
                    ]
                },
                question: {
                    text: "¬øCual es una caracteristica esencial de la firma digital?",
                    options: [
                        "Solo sirve para documentos informales",
                        "Garantiza que el documento no fue alterado",
                        "Cualquiera puede crearla sin certificado",
                        "No tiene reconocimiento legal"
                    ],
                    correct: 1,
                    hints: [
                        "La firma tradicional busca asegurar que tu aprobaste algo, ¬øque mas necesitarias garantizar en el mundo digital?",
                        "Piensa en la integridad del documento ademas de la identidad..."
                    ]
                }
            },
            {
                id: 7,
                title: "Privacidad en Internet",
                description: "Proteccion de la intimidad en el entorno digital",
                color: "#C5B8D6",
                icon: "üëÅ",
                content: {
                    points: [
                        "Los usuarios tienen derecho a controlar su informacion en linea",
                        "Las cookies y rastreadores deben informarse al usuario",
                        "El derecho al olvido permite eliminar informacion personal",
                        "Las politicas de privacidad deben ser claras y accesibles"
                    ]
                },
                question: {
                    text: "¬øQue es el derecho al olvido en internet?",
                    options: [
                        "Olvidar las contrase√±as de las cuentas",
                        "El derecho a que se elimine informacion personal de internet",
                        "No recordar sitios web visitados",
                        "Borrar el historial del navegador"
                    ],
                    correct: 1,
                    hints: [
                        "Si buscas tu nombre en internet y encuentras informacion que ya no quieres que aparezca...",
                        "Este derecho te permite solicitar algo a las plataformas sobre tus datos antiguos..."
                    ]
                }
            },
            {
                id: 8,
                title: "Ciberseguridad Legal",
                description: "Marco juridico para la seguridad informatica",
                color: "#D6C5B8",
                icon: "üîí",
                content: {
                    points: [
                        "Las organizaciones deben implementar medidas de seguridad",
                        "Existen obligaciones legales de notificar brechas de seguridad",
                        "La negligencia en seguridad puede generar responsabilidad legal",
                        "Los estandares de seguridad son cada vez mas regulados"
                    ]
                },
                question: {
                    text: "¬øQue obligacion tienen las organizaciones ante una brecha de seguridad?",
                    options: [
                        "No tienen ninguna obligacion",
                        "Solo deben reparar el sistema",
                        "Deben notificar a los afectados y autoridades",
                        "Pueden mantenerlo en secreto"
                    ],
                    correct: 2,
                    hints: [
                        "Si tus datos fueron expuestos, ¬øno te gustaria saberlo?",
                        "La transparencia es fundamental cuando la seguridad de otros esta comprometida..."
                    ]
                }
            }
        ];

        // Estado de la aplicaci√≥n
        let appState = {
            studentName: '',
            completedTopics: [],
            currentTopic: null,
            attempts: {}
        };

        // Iniciar el m√≥dulo despu√©s del registro
        function startModule() {
            const nameInput = document.getElementById('studentName');
            const name = nameInput.value.trim();
            
            if (name.length < 3) {
                document.getElementById('registerError').style.display = 'block';
                nameInput.focus();
                return;
            }
            
            appState.studentName = name;
            document.getElementById('displayName').textContent = name;
            document.getElementById('registerScreen').classList.add('hidden');
            document.getElementById('moduleScreen').classList.remove('hidden');
            
            renderCards();
        }

        // Renderizar las tarjetas de temas
        function renderCards() {
            const container = document.getElementById('cardsContainer');
            container.innerHTML = '';
            
            topicsData.forEach(topic => {
                const isCompleted = appState.completedTopics.includes(topic.id);
                const card = document.createElement('div');
                card.className = `topic-card ${isCompleted ? 'completed' : ''}`;
                card.onclick = () => openTopicModal(topic);
                
                card.innerHTML = `
                    <div class="card-visual" style="background: linear-gradient(135deg, ${topic.color}40 0%, ${topic.color}20 100%);">
                        <span class="card-icon" style="color: ${topic.color};">${topic.icon}</span>
                    </div>
                    <div class="card-content">
                        <h3>${topic.title}</h3>
                        <p>${topic.description}</p>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }

        // Abrir modal con contenido del tema
        function openTopicModal(topic) {
            appState.currentTopic = topic;
            const isCompleted = appState.completedTopics.includes(topic.id);
            
            document.getElementById('modalTitle').textContent = topic.title;
            
            const pointsList = topic.content.points.map(point => `<li>${point}</li>`).join('');
            const optionsList = topic.question.options.map((option, index) => `
                <li class="option-item">
                    <button class="option-btn" onclick="checkAnswer(${index})" ${isCompleted ? 'disabled' : ''}>
                        ${String.fromCharCode(65 + index)}. ${option}
                    </button>
                </li>
            `).join('');
            
            document.getElementById('modalBody').innerHTML = `
                <div class="infographic" style="border-top: 4px solid ${topic.color};">
                    <div class="infographic-title">
                        <h3>${topic.title}</h3>
                    </div>
                    <ul class="info-points">
                        ${pointsList}
                    </ul>
                </div>
                
                <div class="question-section">
                    <h4>Pregunta de comprension</h4>
                    <p style="margin-bottom: 15px; color: var(--text-primary);">${topic.question.text}</p>
                    <ul class="options-list" id="optionsList">
                        ${optionsList}
                    </ul>
                    <div class="feedback" id="feedbackArea"></div>
                    ${isCompleted ? '<p style="color: var(--success-color); margin-top: 15px; font-weight: 500;">Ya completaste este tema correctamente.</p>' : ''}
                </div>
            `;
            
            document.getElementById('modalOverlay').classList.add('active');
        }

        // Verificar respuesta seleccionada
        function checkAnswer(selectedIndex) {
            const topic = appState.currentTopic;
            const feedbackArea = document.getElementById('feedbackArea');
            const buttons = document.querySelectorAll('.option-btn');
            
            // Inicializar intentos para este tema si no existen
            if (!appState.attempts[topic.id]) {
                appState.attempts[topic.id] = 0;
            }
            
            if (selectedIndex === topic.question.correct) {
                // Respuesta correcta
                buttons[selectedIndex].classList.add('correct');
                buttons.forEach(btn => btn.disabled = true);
                
                feedbackArea.className = 'feedback success show';
                feedbackArea.innerHTML = `
                    <h5>Excelente trabajo</h5>
                    <p>Has demostrado comprension del tema. Continua explorando los demas conceptos.</p>
                `;
                
                // Marcar como completado
                if (!appState.completedTopics.includes(topic.id)) {
                    appState.completedTopics.push(topic.id);
                    updateProgress();
                }
                
                // Actualizar tarjeta despu√©s de un momento
                setTimeout(() => {
                    renderCards();
                    checkCompletion();
                }, 1500);
                
            } else {
                // Respuesta incorrecta
                buttons[selectedIndex].classList.add('incorrect');
                appState.attempts[topic.id]++;
                
                const hintIndex = Math.min(appState.attempts[topic.id] - 1, topic.question.hints.length - 1);
                
                feedbackArea.className = 'feedback hint show';
                feedbackArea.innerHTML = `
                    <h5>Reflexiona un momento</h5>
                    <p>${topic.question.hints[hintIndex]}</p>
                `;
                
                // Remover clase de incorrecto despu√©s de un momento para permitir otro intento
                setTimeout(() => {
                    buttons[selectedIndex].classList.remove('incorrect');
                }, 1500);
            }
        }

        // Actualizar barra de progreso
        function updateProgress() {
            const total = topicsData.length;
            const completed = appState.completedTopics.length;
            const percentage = (completed / total) * 100;
            
            document.getElementById('progressFill').style.width = `${percentage}%`;
            document.getElementById('progressText').textContent = `${completed} de ${total} completados`;
        }

        // Verificar si se complet√≥ todo el m√≥dulo
        function checkCompletion() {
            if (appState.completedTopics.length === topicsData.length) {
                setTimeout(() => {
                    closeModal();
                    showCertificate();
                }, 2000);
            }
        }

        // Mostrar pantalla de certificado
        function showCertificate() {
            document.getElementById('moduleScreen').classList.add('hidden');
            document.getElementById('certificateScreen').classList.add('active');
            document.getElementById('certificateName').textContent = appState.studentName;
            
            const today = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('certificateDate').textContent = today.toLocaleDateString('es-ES', options);
        }

        // Descargar certificado como PDF
        async function downloadCertificate() {
            const { jsPDF } = window.jspdf;
            const certificate = document.getElementById('certificateContent');
            
            try {
                const canvas = await html2canvas(certificate, {
                    scale: 2,
                    useCORS: true,
                    backgroundColor: '#ffffff'
                });
                
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF('landscape', 'mm', 'a4');
                
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = pdf.internal.pageSize.getHeight();
                const imgWidth = canvas.width;
                const imgHeight = canvas.height;
                const ratio = Math.min(pdfWidth / imgWidth, pdfHeight / imgHeight);
                
                const imgX = (pdfWidth - imgWidth * ratio) / 2;
                const imgY = (pdfHeight - imgHeight * ratio) / 2;
                
                pdf.addImage(imgData, 'PNG', imgX, imgY, imgWidth * ratio, imgHeight * ratio);
                pdf.save(`Certificado_Legislacion_Informatica_${appState.studentName.replace(/\s+/g, '_')}.pdf`);
                
            } catch (error) {
                console.error('Error al generar PDF:', error);
                alert('Hubo un error al generar el PDF. Por favor, intenta de nuevo.');
            }
        }

        // Cerrar modal
        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('active');
            appState.currentTopic = null;
        }

        // Reiniciar m√≥dulo
        function restartModule() {
            appState = {
                studentName: '',
                completedTopics: [],
                currentTopic: null,
                attempts: {}
            };
            
            document.getElementById('certificateScreen').classList.remove('active');
            document.getElementById('moduleScreen').classList.add('hidden');
            document.getElementById('registerScreen').classList.remove('hidden');
            document.getElementById('studentName').value = '';
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('progressText').textContent = '0 de 8 completados';
        }

        // Cerrar modal al hacer clic fuera
        document.getElementById('modalOverlay').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Cerrar modal con tecla Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // Permitir Enter en el campo de nombre
        document.getElementById('studentName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                startModule();
            }
        });
    </script>
</body>
</html>